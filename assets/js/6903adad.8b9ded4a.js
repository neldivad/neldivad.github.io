"use strict";(self.webpackChunknelverse=self.webpackChunknelverse||[]).push([[5123],{5917:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>p,contentTitle:()=>u,default:()=>y,frontMatter:()=>h,metadata:()=>r,toc:()=>x});const r=JSON.parse('{"id":"probability/gacha","title":"Gacha Calculator","description":"This comprehensive suite of interactive calculators helps you understand gacha systems and general gacha mechanics analysis.","source":"@site/labs/probability/gacha.mdx","sourceDirName":"probability","slug":"/probability/gacha-calculator","permalink":"/labs/probability/gacha-calculator","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Gacha Calculator","slug":"gacha-calculator"},"sidebar":"defaultSidebar","previous":{"title":"A/B Test Trial Simulation","permalink":"/labs/probability/abtest"},"next":{"title":"Kelly Criterion","permalink":"/labs/probability/kelly-criterion"}}');var a=s(74848),n=s(28453),i=s(78478),l=s(96540);function o(){const e=(0,l.useRef)(null),[t,r]=(0,l.useState)(.5),[n,i]=(0,l.useState)(1),[o,c]=(0,l.useState)(!1),[d,h]=(0,l.useState)(90),[u,p]=(0,l.useState)(75),[x,m]=(0,l.useState)(!1),[y,g]=(0,l.useState)(50),j=(e,t,s,r,a,n,i)=>{const l=[],o=[];let c=[];s&&(c=((e,t,s)=>{const r=new Array(s+1).fill(0);r[0]=0;for(let a=1;a<t;a++)r[a]=e/100;if(t<s)for(let a=t;a<s;a++){const n=(a-t)/(s-t);r[a]=e/100+n*(1-e/100)}return r[s]=1,r})(e,r,a));const d=[.25,.5,.75,.9],h=[];let u=1,p=new Set;for(;u<=2e3;){let r=0;for(let l=0;l<30;l++){let a=0,l=0;for(let t=1;t<=u;t++){let t=e/100;s&&l<c.length&&(t=c[l+1]),Math.random()<t?((!n||Math.random()<i/100)&&a++,l=0):l++}a>=t&&r++}const a=r/30;l.push(u),o.push(a);for(const e of d)!p.has(e)&&a>=e&&(h.push({prob:e,attempts:u}),p.add(e));if(a>=.95)break;u+=5}return{attempts:l,cumulativeProb:o,markers:h}},b=(0,l.useMemo)((()=>{const e=[],s=[],r=j(t,n,!1,0,0,!1,0);if(e.push({x:r.attempts,y:r.cumulativeProb,type:"scatter",mode:"lines",name:"Base",line:{color:"#3498db",width:1},hovertemplate:"%{x}"}),r.markers.forEach((e=>{s.push({...e,name:"Base",color:"#3498db"})})),o){const r=j(t,n,!0,u,d,!1,0);e.push({x:r.attempts,y:r.cumulativeProb,type:"scatter",mode:"lines",name:"Pity Adjusted",line:{color:"#e74c3c",width:1},hovertemplate:"%{x}"}),r.markers.forEach((e=>{s.push({...e,name:"Pity Adjusted",color:"#e74c3c"})}))}if(o&&x){const r=j(t,n,!0,u,d,!0,y);e.push({x:r.attempts,y:r.cumulativeProb,type:"scatter",mode:"lines",name:"Pity + Bernoulli",line:{color:"#2ecc71",width:1},hovertemplate:"%{x}"}),r.markers.forEach((e=>{s.push({...e,name:"Pity + Bernoulli",color:"#2ecc71"})}))}return e.markers=s,e}),[t,n,o,u,d,x,y]);return(0,l.useEffect)((()=>{if(!e.current||0===b.length)return;const t=s(84708),r=[],a=[],i=(b.markers||[]).reduce(((e,t)=>{const s=100*t.prob+"%";return e[s]||(e[s]=[]),e[s].push(t),e}),{});Object.entries(i).forEach((([e,t])=>{const s=t[0].prob;r.push({type:"line",y0:s,y1:s,line:{color:"rgba(128, 128, 128, 0.3)",width:1,dash:"dot"},layer:"below"}),a.push({y:s,text:e,showarrow:!1,font:{size:10,color:"rgba(19, 18, 18, 0.8)"},bgcolor:"rgba(255, 255, 255, 0.8)",bordercolor:"rgba(128, 128, 128, 0.3)",borderwidth:1,xanchor:"right",yanchor:"middle"})}));const l={title:{text:`Cumulative Probability vs Attempts (Target: ${n} copies)`,font:{size:16}},xaxis:{title:{text:"Attempts"},type:"linear"},yaxis:{title:{text:"Cumulative Probability"},type:"linear",range:[0,1],showticklabels:!1},margin:{t:60,r:10,b:60,l:50},hovermode:"y unified",showlegend:!0,legend:{x:.02,y:.98,bgcolor:"rgba(255,255,255,0.8)",bordercolor:"rgba(0,0,0,0.2)",borderwidth:1},shapes:r,annotations:a};t.newPlot(e.current,b,l,{responsive:!0,displayModeBar:!0,modeBarButtonsToRemove:["pan2d","lasso2d","select2d"]})}),[b,n]),(0,a.jsxs)("div",{style:{padding:"20px"},children:[(0,a.jsx)("h3",{children:"Gacha Cumulative Probability Chart"}),(0,a.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"20px",marginBottom:"20px",padding:"15px",border:"1px solid #ddd",borderRadius:"8px"},children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{children:"Basic Parameters"}),(0,a.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,a.jsxs)("label",{children:["Base Probability (%): ",t,"%"]}),(0,a.jsx)("input",{type:"range",min:"0.1",max:"10",step:"0.1",value:t,onChange:e=>r(parseFloat(e.target.value)),style:{width:"100%"}})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{children:["Target Copies: ",n]}),(0,a.jsx)("input",{type:"range",min:"1",max:"10",step:"1",value:n,onChange:e=>i(parseInt(e.target.value)),style:{width:"100%"}})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{children:"Pity System"}),(0,a.jsx)("div",{style:{marginBottom:"15px"},children:(0,a.jsxs)("label",{children:[(0,a.jsx)("input",{type:"checkbox",checked:o,onChange:e=>c(e.target.checked)}),"Pity Adjust"]})}),o&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,a.jsxs)("label",{children:["Pity Peak: ",d]}),(0,a.jsx)("input",{type:"range",min:"10",max:"100",step:"1",value:d,onChange:e=>{const t=parseInt(e.target.value);h(t),t<u&&p(t)},style:{width:"100%"}})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{children:["Pity Start: ",u]}),(0,a.jsx)("input",{type:"range",min:"10",max:d,step:"1",value:u,onChange:e=>{const t=parseInt(e.target.value);p(t),t>d&&h(t)},style:{width:"100%"}})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{children:"Bernoulli System"}),(0,a.jsx)("div",{style:{marginBottom:"15px"},children:(0,a.jsxs)("label",{children:[(0,a.jsx)("input",{type:"checkbox",checked:x,onChange:e=>m(e.target.checked)}),"Bernoulli Adjust"]})}),x&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{children:["Bernoulli Probability (%): ",y,"%"]}),(0,a.jsx)("input",{type:"range",min:"10",max:"100",step:"1",value:y,onChange:e=>g(parseInt(e.target.value)),style:{width:"100%"}})]})]})]}),(0,a.jsx)("div",{ref:e,style:{width:"100%",height:"500px"}}),(0,a.jsxs)("div",{style:{marginTop:"20px",padding:"15px",borderRadius:"8px"},children:[(0,a.jsx)("h4",{children:"Chart Information"}),(0,a.jsxs)("p",{children:["This chart shows the required amount of attempts to reach a cumulative probability of obtaining ",(0,a.jsxs)("strong",{children:[n," target copies"]})," of a limited character ",(0,a.jsx)("strong",{children:"you intend"})," to pull. Each line represents a different gacha system configuration:"]}),(0,a.jsxs)("ul",{children:[(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"Base:"})," Standard gacha with ",t,"% base rate"]}),o&&(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"Pity Adjusted:"})," Includes pity system (starts at ",u,", peaks at ",d,")"]}),o&&x&&(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"Pity + Bernoulli:"})," Full system with pity and ",y,"% bernoulli probability"]})]})]})]})}function c(){const e=(0,l.useRef)(null),[t,r]=(0,l.useState)(.5),[n,i]=(0,l.useState)(1e3),[o,c]=(0,l.useState)(200),[h,u]=(0,l.useState)(!1),[p,x]=(0,l.useState)(80),[m,y]=(0,l.useState)(70),[g,j]=(0,l.useState)(!1),[b,f]=(0,l.useState)(50),v=(0,l.useMemo)((()=>{const e=[],s=d(t/100,n,!1,0,0,!1,0,o);if(e.push({name:"Base",data:s,color:"#3498db"}),h){const s=d(t/100,n,!0,m,p,!1,0,o);e.push({name:"Pity Adjusted",data:s,color:"#e74c3c"})}if(h&&g){const s=d(t/100,n,!0,m,p,!0,b/100,o);e.push({name:"Pity + Bernoulli",data:s,color:"#2ecc71"})}if(!h&&g){const s=d(t/100,n,!1,0,0,!0,b/100,o);e.push({name:"Bernoulli Adjusted",data:s,color:"#2ecc71"})}return e}),[t,n,o,h,p,m,g,b]),w=(0,l.useMemo)((()=>v.map((({name:e,data:t,color:s})=>{const r=Math.max(...t),a=new Array(r+1).fill(0);t.forEach((e=>{a[e]++}));const n=a.map((e=>e/t.length));return{x:a.map(((e,t)=>t)),y:n,type:"bar",name:e,marker:{color:s,opacity:.4},yaxis:"y"}}))),[v]);return(0,l.useEffect)((()=>{if(!e.current||0===w.length)return;s(84708).newPlot(e.current,w,{title:{text:"SSR Count Distribution",font:{size:16}},xaxis:{title:{text:"Intended SSR Count"},type:"linear"},yaxis:{title:{text:"Frequency"},type:"linear"},barmode:"overlay",margin:{t:60,r:10,b:60,l:50},showlegend:!0,legend:{x:.02,y:.98,bgcolor:"rgba(255,255,255,0.8)",bordercolor:"rgba(0,0,0,0.2)",borderwidth:1}},{responsive:!0,displayModeBar:!0,modeBarButtonsToRemove:["pan2d","lasso2d","select2d"]})}),[w]),(0,a.jsxs)("div",{style:{padding:"20px"},children:[(0,a.jsx)("h3",{children:"Gacha Probability Histogram"}),(0,a.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"20px",marginBottom:"20px",padding:"15px",border:"1px solid #ddd",borderRadius:"8px"},children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{children:"Basic Parameters"}),(0,a.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,a.jsxs)("label",{children:["Base Probability (%): ",t,"%"]}),(0,a.jsx)("input",{type:"range",min:"0.1",max:"10",step:"0.1",value:t,onChange:e=>r(parseFloat(e.target.value)),style:{width:"100%"}})]}),(0,a.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,a.jsxs)("label",{children:["Attempts: ",n]}),(0,a.jsx)("input",{type:"range",min:"100",max:"5000",step:"10",value:n,onChange:e=>i(parseInt(e.target.value)),style:{width:"100%"}})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{children:["Simulation Count: ",o]}),(0,a.jsx)("input",{type:"range",min:"50",max:"500",step:"50",value:o,onChange:e=>c(parseInt(e.target.value)),style:{width:"100%"}})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{children:"Pity System"}),(0,a.jsx)("div",{style:{marginBottom:"15px"},children:(0,a.jsxs)("label",{children:[(0,a.jsx)("input",{type:"checkbox",checked:h,onChange:e=>u(e.target.checked)}),"Pity Adjust"]})}),h&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,a.jsxs)("label",{children:["Pity Peak: ",p]}),(0,a.jsx)("input",{type:"range",min:"10",max:"100",step:"1",value:p,onChange:e=>{const t=parseInt(e.target.value);x(t),t<m&&y(t)},style:{width:"100%"}})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{children:["Pity Start: ",m]}),(0,a.jsx)("input",{type:"range",min:"10",max:p,step:"1",value:m,onChange:e=>{const t=parseInt(e.target.value);y(t),t>p&&x(t)},style:{width:"100%"}})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{children:"Bernoulli System"}),(0,a.jsx)("div",{style:{marginBottom:"15px"},children:(0,a.jsxs)("label",{children:[(0,a.jsx)("input",{type:"checkbox",checked:g,onChange:e=>j(e.target.checked)}),"Bernoulli Adjust"]})}),g&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{children:["Bernoulli Probability (%): ",b,"%"]}),(0,a.jsx)("input",{type:"range",min:"1",max:"100",step:"1",value:b,onChange:e=>f(parseInt(e.target.value)),style:{width:"100%"}})]})]})]}),(0,a.jsx)("div",{ref:e,style:{width:"100%",height:"500px"}}),(0,a.jsxs)("div",{style:{marginTop:"20px"},children:[(0,a.jsx)("h4",{children:"Statistics"}),v.map((({name:e,data:t,color:s})=>{const r=t.reduce(((e,t)=>e+t),0)/t.length,n=t.reduce(((e,t)=>e+(t-r)**2),0)/t.length;return(0,a.jsxs)("div",{style:{marginBottom:"10px"},children:[(0,a.jsxs)("span",{style:{color:s,fontWeight:"bold"},children:[e,":"]}),(0,a.jsxs)("span",{style:{marginLeft:"10px"},children:["Expected SSR: ",r.toFixed(2),", Variance: ",n.toFixed(2)]})]},e)}))]})]})}function d(e,t,s,r,a,n,i,l){const o=[];let c=[];s&&(c=function(e,t,s){const r=new Array(s+1).fill(0);r[0]=0;for(let a=1;a<t;a++)r[a]=e;if(t<s)for(let a=t;a<s;a++){const n=(a-t)/(s-t);r[a]=e+n*(1-e)}return r[s]=1,r}(e,r,a));for(let d=0;d<l;d++){let r=0,a=0;for(let l=1;l<=t;l++){let t=e;s&&a<c.length&&(t=c[a+1]),Math.random()<t?((!n||Math.random()<i)&&r++,a=0):a++}o.push(r)}return o}const h={title:"Gacha Calculator",slug:"gacha-calculator"},u=void 0,p={},x=[{value:"Cumulative Probability Chart",id:"cumulative-probability-chart",level:2},{value:"SSR Count Distribution",id:"ssr-count-distribution",level:2}];function m(e){const t={admonition:"admonition",h2:"h2",hr:"hr",li:"li",p:"p",strong:"strong",ul:"ul",...(0,n.R)(),...e.components},{Details:s}=t;return s||function(e,t){throw new Error("Expected "+(t?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.p,{children:"This comprehensive suite of interactive calculators helps you understand gacha systems and general gacha mechanics analysis."}),"\n",(0,a.jsxs)(t.admonition,{title:"Understanding the Pity System",type:"info",children:[(0,a.jsx)(t.p,{children:'The gacha system features a "soft pity" mechanism where drop rates increase significantly after certain thresholds, and a hard pity that guarantees a limited drop at threshold.'}),(0,a.jsx)(t.p,{children:"Using Genshin Impact as an example:"}),(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"Elite Characters"}),": Base rate 0.5%, soft pity starts at 75 draws, hard pity at 90 draws"]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"Elite Weapons"}),": Base rate 0.5%, soft pity starts at 65 draws, hard pity at 80 draws"]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"50/50"}),": Meaning there is a 50% chance to get the event limited character."]}),"\n"]})]}),"\n",(0,a.jsxs)(s,{children:[(0,a.jsx)("summary",{children:"Example settings"}),(0,a.jsx)(t.p,{children:"The example parameters you will select for Genshin Impact will be:"}),(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"Pity Peak: 90"}),"\n",(0,a.jsx)(t.li,{children:"Pity Start: 75"}),"\n",(0,a.jsx)(t.li,{children:"Bernuolli Probability: 50"}),"\n"]}),(0,a.jsx)(t.p,{children:"Different games have different rates, example Bernuolli rate of 75/25 for HSR lightcones, or 100/0 for Wuthering Wave's weapon."})]}),"\n",(0,a.jsx)(t.h2,{id:"cumulative-probability-chart",children:"Cumulative Probability Chart"}),"\n",(0,a.jsx)(t.p,{children:"This chart shows how many attempts you need to reach specific probability thresholds for obtaining target copies."}),"\n",(0,a.jsxs)(t.admonition,{type:"info",children:[(0,a.jsx)(t.p,{children:'Suppose you intend to C6 a limited character from Genshin Impact, you will read the green line "Bernuolli + Pity adjust".'}),(0,a.jsx)(t.p,{children:"At default settings, it works out to ~1300 rolling attempts to have a 95% chance of maxing out your character."})]}),"\n",(0,a.jsx)(i.A,{children:()=>(0,a.jsx)(o,{})}),"\n",(0,a.jsx)(t.hr,{}),"\n",(0,a.jsx)(t.h2,{id:"ssr-count-distribution",children:"SSR Count Distribution"}),"\n",(0,a.jsxs)(t.p,{children:["This histogram shows the distribution of expected counts of the SSR ",(0,a.jsx)(t.strong,{children:"you want"})," from a given number of attempts."]}),"\n",(0,a.jsx)(i.A,{children:()=>(0,a.jsx)(c,{})})]})}function y(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(m,{...e})}):m(e)}},28453:(e,t,s)=>{s.d(t,{R:()=>i,x:()=>l});var r=s(96540);const a={},n=r.createContext(a);function i(e){const t=r.useContext(n);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),r.createElement(n.Provider,{value:t},e.children)}},78478:(e,t,s)=>{s.d(t,{A:()=>n});s(96540);var r=s(92303),a=s(74848);function n({children:e,fallback:t}){return(0,r.A)()?(0,a.jsx)(a.Fragment,{children:e?.()}):t??null}}}]);