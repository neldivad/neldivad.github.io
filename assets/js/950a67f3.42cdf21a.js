"use strict";(self.webpackChunknelverse=self.webpackChunknelverse||[]).push([[8080],{28453:(e,t,i)=>{i.d(t,{R:()=>s,x:()=>o});var n=i(96540);const l={},r=n.createContext(l);function s(e){const t=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:s(e.components),n.createElement(r.Provider,{value:t},e.children)}},76164:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>u,contentTitle:()=>c,default:()=>x,frontMatter:()=>h,metadata:()=>n,toc:()=>p});const n=JSON.parse('{"id":"probability/kelly","title":"Kelly Criterion","description":"This page demonstrates the Kelly Criterion interactively. Use the slider to scale the optimal fraction.","source":"@site/labs/probability/kelly.mdx","sourceDirName":"probability","slug":"/probability/kelly-criterion","permalink":"/labs/probability/kelly-criterion","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Kelly Criterion","slug":"kelly-criterion"},"sidebar":"defaultSidebar","previous":{"title":"Gacha Calculator","permalink":"/labs/probability/gacha-calculator"},"next":{"title":"Poker Odds","permalink":"/labs/probability/poker-odds"}}');var l=i(74848),r=i(28453),s=i(78478),o=i(96540);function a(e,t){return 0===t?0:(t*e-(1-e))/t}function d({pSteps:e=21,bSteps:t=21,maxOdds:n=20,kellyMultiplier:r=1}){const s=(0,o.useRef)(null),[d,h]=(0,o.useState)(n),[c,u]=(0,o.useState)(e),[p,m]=(0,o.useState)(t),[x,f]=(0,o.useState)(r),g=(0,o.useMemo)((()=>{const e=Array.from({length:c},((e,t)=>t/(c-1)*100)),t=Array.from({length:p},((e,t)=>t/(p-1)*d)),i=t.map((()=>Array(e.length).fill(0)));for(let n=0;n<t.length;n++)for(let l=0;l<e.length;l++){const r=e[l]/100,s=Math.max(0,a(r,t[n]));i[n][l]=100*Math.min(1,s*x)}return{pVals:e,bVals:t,z:i}}),[c,p,d,x]);return(0,o.useEffect)((()=>{let e=!1;return(async()=>{if(!s.current)return;const t=(await i.e(4708).then(i.t.bind(i,84708,23))).default,n=[{x:g.pVals,y:g.bVals,z:g.z,type:"heatmap",colorscale:"Viridis",reversescale:!1,zmin:0,zmax:100,colorbar:{title:"Bet size (%)",tickformat:".0f",ticksuffix:"%"}}];await t.newPlot(s.current,n,{title:{text:"<b>Kelly Bet Size</b>",font:{size:14}},xaxis:{title:{text:"Assumed probability (%)",font:{size:12}},tickformat:".0f",ticksuffix:"%"},yaxis:{title:{text:"Winnings multiplier",font:{size:12}}},zaxis:{title:{text:"Bet size",font:{size:12}}},margin:{t:60,r:10,b:60,l:60}},{displayModeBar:!1}),e&&t.purge(s.current)})(),()=>{e=!0}}),[g]),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{style:{display:"grid",gap:8,gridTemplateColumns:"repeat(3, 1fr)"},children:[(0,l.jsxs)("label",{children:["max odds: ",d.toFixed(0),(0,l.jsx)("input",{type:"range",min:5,max:50,step:1,value:d,onChange:e=>h(Number(e.target.value))})]}),(0,l.jsxs)("label",{children:["p steps: ",c,(0,l.jsx)("input",{type:"range",min:11,max:101,step:2,value:c,onChange:e=>u(Number(e.target.value))})]}),(0,l.jsxs)("label",{children:["odds steps: ",p,(0,l.jsx)("input",{type:"range",min:11,max:51,step:2,value:p,onChange:e=>m(Number(e.target.value))})]}),(0,l.jsxs)("label",{children:["Kelly K: ",x.toFixed(1),(0,l.jsx)("input",{type:"range",min:.1,max:2,step:.1,value:x,onChange:e=>f(Number(e.target.value))})]})]}),(0,l.jsx)("div",{ref:s,style:{height:600,width:"100%"}})]})}const h={title:"Kelly Criterion",slug:"kelly-criterion"},c=void 0,u={},p=[{value:"Return vs. Volatility",id:"return-vs-volatility",level:2},{value:"Heatmap",id:"heatmap",level:2}];function m(e){const t={a:"a",admonition:"admonition",em:"em",h2:"h2",hr:"hr",li:"li",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components},{Details:i}=t;return i||function(e,t){throw new Error("Expected "+(t?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(t.p,{children:"This page demonstrates the Kelly Criterion interactively. Use the slider to scale the optimal fraction."}),"\n",(0,l.jsx)(t.h2,{id:"return-vs-volatility",children:"Return vs. Volatility"}),"\n",(0,l.jsxs)(t.admonition,{type:"info",children:[(0,l.jsx)(t.p,{children:(0,l.jsx)(t.strong,{children:"Parameters"})}),(0,l.jsxs)(t.ul,{children:["\n",(0,l.jsx)(t.li,{children:"Odds: Winnings multiplier (1.0 = even odds, 2.0 = double your money)"}),"\n",(0,l.jsx)(t.li,{children:"Edge: Probability of winning"}),"\n",(0,l.jsx)(t.li,{children:"Sims: Simulated trials for return/volatility analysis"}),"\n",(0,l.jsx)(t.li,{children:"Paths: Number of independent simulation runs (10-50 range)"}),"\n"]})]}),"\n",(0,l.jsxs)(i,{children:[(0,l.jsx)(t.p,{children:(0,l.jsx)(t.strong,{children:"Top Chart (Return vs. Volatility):"})}),(0,l.jsxs)(t.ul,{children:["\n",(0,l.jsx)(t.li,{children:"X: Kelly multiplier"}),"\n",(0,l.jsx)(t.li,{children:"Y1: Expected log growth rate (blue curve)"}),"\n",(0,l.jsx)(t.li,{children:"Y2: Standard deviation of log growth (red curve)"}),"\n",(0,l.jsx)(t.li,{children:"Y3: Risk-adjusted growth (Green dotted)"}),"\n"]}),(0,l.jsx)(t.admonition,{title:"Help",type:"success",children:(0,l.jsxs)(t.ul,{children:["\n",(0,l.jsx)(t.li,{children:"Green shaded refers to optimal risk-adjusted Kelly range"}),"\n",(0,l.jsx)(t.li,{children:"Yellow shaded refers to growth maximizing range"}),"\n",(0,l.jsx)(t.li,{children:"Red shaded refers to ruin range"}),"\n"]})}),(0,l.jsx)(t.p,{children:(0,l.jsx)(t.strong,{children:"Middle Chart (Monte Carlo Paths):"})}),(0,l.jsxs)(t.ul,{children:["\n",(0,l.jsx)(t.li,{children:"Shows 4 Kelly multiplier strategies: 0.25\xd7, 0.5\xd7, 1\xd7, 1.5\xd7 Kelly"}),"\n",(0,l.jsx)(t.li,{children:"Each line shows multiple simulation paths with average highlighted"}),"\n",(0,l.jsx)(t.li,{children:"Uses 10% of sims for trials to conserve bandwidth"}),"\n",(0,l.jsx)(t.li,{children:'Click "New Simulation" to generate fresh random paths'}),"\n"]}),(0,l.jsx)(t.p,{children:(0,l.jsx)(t.strong,{children:"Bottom Chart (Ending Value Distribution):"})}),(0,l.jsxs)(t.ul,{children:["\n",(0,l.jsx)(t.li,{children:"Histogram showing distribution of final portfolio values"}),"\n",(0,l.jsx)(t.li,{children:"Overlaid histograms for each Kelly multiplier"}),"\n",(0,l.jsx)(t.li,{children:"X-axis shows log\u2081\u2080 of final portfolio values (linear scale)"}),"\n",(0,l.jsx)(t.li,{children:"Shows probability density of different outcomes"}),"\n"]})]}),"\n",(0,l.jsx)(t.p,{children:"Recommended bet size should be below 0.8 K. At K greater than 1.5, your chances of ruin gets extremely high."}),"\n",(0,l.jsx)(t.p,{children:"In fact, you notice that ruin can happen even before K reaches 1.5 when your edge or odds goes high enough."}),"\n",(0,l.jsx)(t.p,{children:"That is another way of saying Kelly sometimes gets too overconfident in certain games, and recommends you to bet extremely big (more than 60% of your portfolio), which may work out well in few iterations, but one big loss is enough to wipe you off."}),"\n",(0,l.jsx)(t.admonition,{title:"Migration Alert",type:"warning",children:(0,l.jsx)(t.p,{children:(0,l.jsxs)(t.em,{children:["We have migrated the application to ",(0,l.jsx)(t.a,{href:"https://www.nelworks.com/labs/probability/kelly-criterion",children:"here"})]})})}),"\n",(0,l.jsxs)(i,{children:[(0,l.jsx)("summary",{children:"Note"}),(0,l.jsx)(t.p,{children:"When odds get large enough, you notice a K=0.7 would outperformed a K=1 strategy 50% of the time within 100 games, from the probability density chart."}),(0,l.jsx)(t.p,{children:"However, if you simply observe the average results from a Monte Carlo simulations, you would have think that K=1 is always the best strategy."}),(0,l.jsx)(t.p,{children:"This is one of the problems with going full Kelly -- it tends to bet too much during times when it feels too certain about an outcome."}),(0,l.jsx)(t.p,{children:"This is the kind of information what most people ends up missing. What works in theory is not always the most practical strategy in real life."}),(0,l.jsx)(t.p,{children:"In practice, going full Kelly and setting a bet size limit of 50% is a good heuristic to follow."})]}),"\n",(0,l.jsx)(t.hr,{}),"\n",(0,l.jsx)(t.h2,{id:"heatmap",children:"Heatmap"}),"\n",(0,l.jsxs)(t.admonition,{type:"info",children:[(0,l.jsx)(t.p,{children:(0,l.jsx)(t.strong,{children:"Parameters"})}),(0,l.jsxs)(t.ul,{children:["\n",(0,l.jsx)(t.li,{children:"Max odds: Maximum winnings multiplier to display (e.g., 2.0 = double your money)"}),"\n",(0,l.jsx)(t.li,{children:"P steps: Number of probability intervals (more = smoother heatmap)"}),"\n",(0,l.jsx)(t.li,{children:"Odds steps: Number of multiplier intervals (more = smootherheatmap)"}),"\n",(0,l.jsx)(t.li,{children:"K: Kelly multiplier"}),"\n"]}),(0,l.jsx)(t.p,{children:(0,l.jsx)(t.strong,{children:"Axis"})}),(0,l.jsxs)(t.ul,{children:["\n",(0,l.jsx)(t.li,{children:"X: Assumed probability of winnings"}),"\n",(0,l.jsx)(t.li,{children:"Y: Assumed profit from winnings"}),"\n",(0,l.jsx)(t.li,{children:"Z: Kelly recommended bet size"}),"\n"]})]}),"\n",(0,l.jsx)(s.A,{children:()=>(0,l.jsx)(d,{pSteps:51,bSteps:21,maxOdds:20})})]})}function x(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,l.jsx)(t,{...e,children:(0,l.jsx)(m,{...e})}):m(e)}},78478:(e,t,i)=>{i.d(t,{A:()=>r});i(96540);var n=i(92303),l=i(74848);function r({children:e,fallback:t}){return(0,n.A)()?(0,l.jsx)(l.Fragment,{children:e?.()}):t??null}}}]);